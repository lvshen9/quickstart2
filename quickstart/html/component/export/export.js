(function(){if(typeof($.Export)=="undefined"){$.Export=function(a){return new $.Export.fn.constructor(a);};$.Export.findParent=function(b,a){var c=null;if(b){c=b;while(c!=null&&c.nodeName!="BODY"){if($(c).attr("id")==a){return true;}else{c=c.parentNode;}}}return false;};$.Export.fn={constructor:function(a){this.userDefinedId=a;
},getExportInitData:function(e,c,g){var b="";b+="listenerMethod=initTimer&serviceName="+e;if(g){if(g.substring(0,1)=="?"){b+="&"+g.substring(1,g.length);}else{if(g.substring(0,1)=="&"){b+=g;}else{b+="&"+g;}}}var a="0";var d="00:00";var f="0";$.ajaxRequest({url:$.redirect.parseUrl(c),data:b,type:"POST",datatype:"json",async:false,encoding:"UTF-8",success:function(h){h=$.parseJSON(h);
a=h.totalSize;d=h.startTime;f=h.useTime;},error:function(h,i){alert("init failed!");}});return{totalSize:a,startTime:d,useTime:f};},toggleHtml:function(f,b){var e=f+this.userDefinedId;var a=b+this.userDefinedId;var c=$("#"+e);var d=$("#"+a);if(f=="wade_export_"){c.css("visibility","hidden");}else{if(c&&c.length>0){c.css("display","none");
}}if(b=="wade_export_"){d.css("visibility","visible");}else{if(d&&d.length>0){d.css("display","");}}},showExportConfig:function(g,t,r){var d=$("#wade_export_config_article_"+this.userDefinedId);if(d&&d.length>0&&d.html()!=""&&$.trim(d.html())!=""){d.css("display","");var i=window["Export_"+this.userDefinedId].initPosition($("#exportButton"+this.userDefinedId),"320");
var o=i.topPx;var l=i.leftPx;var q=i.widthPx;$("#wade_export_"+this.userDefinedId).css("top",o+"px");$("#wade_export_"+this.userDefinedId).css("left",l+"px");$("#wade_export_"+this.userDefinedId).css("width",q+"px");$("#wade_export_"+this.userDefinedId).css("visibility","visible");window["Export_"+this.userDefinedId].toggleHtml("wade_export_form_","wade_export_");
return;}var f=$("#wade_export_"+this.userDefinedId);if(f&&f.length>0){var i=window["Export_"+this.userDefinedId].initPosition($("#exportButton"+this.userDefinedId),"320");var o=i.topPx;var l=i.leftPx;var q=i.widthPx;$("#wade_export_"+this.userDefinedId).css("top",o+"px");$("#wade_export_"+this.userDefinedId).css("left",l+"px");
$("#wade_export_"+this.userDefinedId).css("width",q+"px");$("#wade_export_"+this.userDefinedId).css("visibility","visible");var s=$("#exportButton"+this.userDefinedId).attr("fileName");if(s&&s!="undefined"&&s!="null"){$("#wade_export_filename_"+this.userDefinedId).val(s);}window["Export_"+this.userDefinedId].toggleHtml("wade_export_config_article_","wade_export_form_");
return;}var e=window["Export_"+this.userDefinedId].configBaseHtml(null,null,null);$.appendContextMenu($("#exportButton"+this.userDefinedId),$("#wade_export_"+this.userDefinedId),e,250,"wade_export_"+this.userDefinedId);$("#wade_export_"+this.userDefinedId).css("visibility","visible");var i=window["Export_"+this.userDefinedId].initPosition($("#exportButton"+this.userDefinedId),"320");
$("#wade_export_"+this.userDefinedId).css("top",i.topPx+"px");$("#wade_export_"+this.userDefinedId).css("left",i.leftPx+"px");$("#wade_export_"+this.userDefinedId).css("width",i.widthPx+"px");var n=$("#exportButton"+this.userDefinedId).attr("timerMode");window["Export_"+this.userDefinedId].handleTimerNews(g,t,r,n);
var p=$("#exportButton"+this.userDefinedId).attr("imMode");if(p==true){}var h=$("#exportButton"+this.userDefinedId).attr("partId");this.partId=h;var j=$("#exportButton"+this.userDefinedId).attr("ftpSite");var k=$("#exportButton"+this.userDefinedId).attr("filePath");var m=$("#exportButton"+this.userDefinedId).attr("action");
var b=$("#exportButton"+this.userDefinedId).attr("beforeAction");var a=$("#exportButton"+this.userDefinedId).attr("afterAction");this.exportAction=m;this.beforeAction=b;this.afterAction=a;if(r&&r.length>0){var c=r.substring(r.length-1,r.length);if(c=="&"||c=="?"){r+="ftpSite="+j+"&filePath="+k;}else{r+="&ftpSite="+j+"&filePath="+k;
}}$("#wade_export_begin_export_"+this.userDefinedId).bind("click",window["Export_"+this.userDefinedId].beginExport(g,t,r,n,p));$("#wade_export_cancel_export_"+this.userDefinedId).bind("click",window["Export_"+this.userDefinedId].cancelConfig());$(document).bind("click",window["Export_"+this.userDefinedId].HiddenLayerInDocument());
},initPosition:function(){var e=$("#exportButton"+this.userDefinedId);var b=$("#exporting"+this.userDefinedId);var c=$("#exportConfig"+this.userDefinedId);var d="wade_export_"+this.userDefinedId;var a=$.initPosition(e,320,d,c,b);return{"topPx":a.topPx,"leftPx":a.leftPx,"widthPx":a.widthPx};},beginExport:function(d,c,f,a,e){var b=this.userDefinedId;
return function(){var i=$("#wade_export_filename_"+b).val();var g=document.getElementById("wade_export_filesuffix_"+b).value;if(!i||i==""||$.trim(i)==""){alert($.lang["view.web.comp.export.filename"]);return;}if(!g||g==""||$.trim(g)==""){alert($.lang["view.web.comp.export.filetype"]);return;}var h=window["Export_"+b].beforeExportAction();
if(h===false){return;}window["Export_"+b].toggleHtml("exportButton","exporting");window["Export_"+b].toggleHtml("wade_export_form_","wade_export_config_article_");window["Export_"+b].showExportDynamicLoading(d,c,f,i+g,a,e);window["Export_"+b].refreshExportDynamicLoading(d,c,f,i+g,a,e);$("#wade_export_cancelLoading_button_"+b).bind("click",function(){window["Export_"+b].onExportAction("terminate");
window["Export_"+b].cancelExportDynamicLoading(d,c,f);});window["Export_"+b].showExportConfig(d,c,f);};},beforeExportAction:function(){var a=true;if(!this.beforeAction){return a;}if($.isFunction(this.beforeAction)){a=this.beforeAction.call(this,this.userDefinedId);}else{a=new Function("return "+this.beforeAction)().call(this,this.userDefinedId);
}return a;},onExportAction:function(b){var a=true;if(!this.exportAction){return a;}if($.isFunction(this.exportAction)){a=this.exportAction.call(this,b,this.userDefinedId);}else{a=new Function("return "+this.exportAction)().call(this,b,this.userDefinedId);}return a;},onAfterAction:function(b){var a=true;
if(!this.afterAction){return a;}if($.isFunction(this.afterAction)){a=this.afterAction.call(this,b,this.userDefinedId);}else{a=new Function("return "+this.afterAction)().call(this,b,this.userDefinedId);}return a;},cancelConfig:function(){var a=this.userDefinedId;return function(){window["Export_"+a].onExportAction("cancel");
window["Export_"+a].initDynamicValue();};},HiddenLayerInDocument:function(){var b="wade_export_"+this.userDefinedId;var c="exportConfig"+this.userDefinedId;var a="exportButton"+this.userDefinedId;return function(f){var d=f.target;if(!$.Export.findParent(d,b)&&!$.Export.findParent(d,c)&&!$.Export.findParent(d,a)){$("#"+b).css("visibility","hidden");
}};},handleTimerNews:function(f,d,e,a){var g="wade_export_timer_"+this.userDefinedId;if(!a||a=="undefined"||a!="true"){$("#"+g).css("display","none");}else{document.getElementById(g).style.display="";var h="wade_export_total_datasize_"+this.userDefinedId;var c="wade_export_start_time_"+this.userDefinedId;
var b="wade_export_export_use_time_"+this.userDefinedId;if($("#"+h).html()=="0"){var i=window["Export_"+this.userDefinedId].getExportInitData(f,d,e);$("#"+h).html(i.totalSize);$("#"+c).html(i.startTime);$("#"+b).html(i.useTime);}}},initDynamicValue:function(){var a="wade_export_total_datasize_"+this.userDefinedId;
var c="wade_export_start_time_"+this.userDefinedId;var b="wade_export_export_use_time_"+this.userDefinedId;window["Export_"+this.userDefinedId].toggleHtml("exporting","exportButton");$("#"+a).html("0");$("#"+c).html("0");$("#"+b).html("0");$("#wade_export_"+this.userDefinedId)[0].style.visibility="hidden";
$("#wade_export_filename_"+this.userDefinedId).val("");},showExportDynamicLoading:function(h,b,c,d,e,g){var a=$("#wade_export_userDefinedFileName_"+this.userDefinedId);if(a&&a.length>0){return;}var i=new Array();i.push("<div>"+$.lang["view.web.comp.export.exporting"]+'<span id="wade_export_userDefinedFileName_'+this.userDefinedId+'">'+d+"</span></div>");
i.push('<span class="e_progress e_progress-big l_mt">');i.push('<span class="e_progressBar" style="width:0%;" id="wade_export_export_progress_bar_'+this.userDefinedId+'"></span>');i.push('<span class="e_progressValue" id="wade_export_export_progress_value_'+this.userDefinedId+'">0%</span>');i.push("</span>");
if(e=="true"){i.push('<div class="l_mt" id="wade_export_export_needTimeDiv_'+this.userDefinedId+'">'+$.lang["view.web.comp.export.needtime"]+'<span class="e_orange" id="wade_export_export_needTime_'+this.userDefinedId+'">00:00:00</span></div>');}i.push('<div><span class="e_tip" id="wade_export_e_tip_'+this.userDefinedId+'">');
i.push($.lang.get("view.web.comp.export.down",'<a href="#nogo" id="wade_export_exportFilePath_'+this.userDefinedId+'">',"</a>"));i.push('</span></div><div class="l_mt e_right">');i.push('<button class="e_button-form"  id="wade_export_loading_button_'+this.userDefinedId+'"><i class="e_ico-ok"></i><span>'+$.lang["view.web.comp.export.ok"]+"</span></button>");
i.push('<button type="button" class="e_button-form l_ml" id="wade_export_cancelLoading_button_'+this.userDefinedId+'"><i class="e_ico-cancel"></i><span>'+$.lang["view.web.comp.export.stop"]+"</span></button>");i.push("</div>");$("#wade_export_config_article_"+this.userDefinedId).html(i.join(""));var f=this.userDefinedId;
$("#wade_export_loading_button_"+this.userDefinedId).bind("click",function(){window["Export_"+f].onExportAction("loading");window["Export_"+f].toggleHtml("wade_export_config_article_");window["Export_"+f].toggleHtml("wade_export_");});},get:function(a){return $.Export(a);},setParams:function(a){$.Export["dynamicParams"].put(this.userDefinedId,a);
},addUrlParams:function(b,a){if(!b){return a;}if(b instanceof $.DataMap){b=$.param(b.map);}else{if($.isString(b)){b=b;}else{b=$.param(b);}}var c=b.substr(0,1);if(c!="?"&&c!="&"){a+="&"+b;}else{if(c=="?"){a+="&"+b.substr(1);}else{if(c=="&"){a+=b;}}}return a;},refreshExportDynamicLoading:function(i,a,b,d,f,h,k){if(k&&k!=""&&k!="undefined"){k=parseInt(k,10);
}else{k=1000;}var c="";c+="listenerMethod=refreshStatus&serviceName="+i+"&fileName="+d;if(b){if(b.substring(0,1)=="?"){c+="&"+b.substring(1,b.length);}else{if(b.substring(0,1)=="&"){c+=b;}else{c+="&"+b;}}}var g=this.userDefinedId;var j=this.partId;function e(){var p=$.Export.fileSerilObj.get(g);var m=c+"&fileSerializeId="+p;
var l=$.Export["dynamicParams"].get(g);if(!p&&l&&l.length>0){m=$.Export.fn.addUrlParams(l,m);}var o="";if(j&&$.isString(j)){var n=[];$.each(j.split(","),function(q,s){n.push($.ajax.buildPostData(s));var r=$("#"+s);if(r&&r.length&&r.attr("exparams")&&r.attr("exparams")!=""){o+=r.attr("exparams");}r=null;
});o+="&"+n.join("&");}if(o&&o!=""){m=$.Export.fn.addUrlParams(o,m);}$.ajaxRequest({url:$.redirect.parseUrl(a),data:m,type:"POST",datatype:"json",encoding:"UTF-8",success:function(v){v=$.parseJSON(v);var t=v.progress;var r=v.status;var x=v.hint;var u=v.fileSerializeId;if(r=="error"){window["Export_"+g].exportFailedHtml(x);
if($.Export.timeoutObj.get(g)){clearTimeout($.Export.timeoutObj.get(g));}$.Export.fileSerilObj.removeKey(g);}else{var w=$("#wade_export_e_tip_"+g);if(w&&w.length>0&&x&&x!="null"&&x!="undefined"){w.html(x);}if(f=="true"){var s=v.needTime;$("#wade_export_export_needTime_"+g).html(s);}if(t&&t!=null&&t!="null"){$("#wade_export_export_progress_bar_"+g).css("width",t+"%");
$("#wade_export_export_progress_value_"+g).html(t+"%");}if(t!="100"){$.Export.fileSerilObj.put(g,u);if($.Export.timeoutObj.get(g)){clearTimeout($.Export.timeoutObj.get(g));}var q=setTimeout(e,k);$.Export.timeoutObj.put(g,q);}else{window["Export_"+g].exportCompleteHtml(d);$("#wade_export_exportFilePath_complete_"+g).attr("href",v.downloadUrl);
if($.Export.timeoutObj.get(g)){clearTimeout($.Export.timeoutObj.get(g));}$.Export.fileSerilObj.removeKey(g);}}},error:function(q,r){window["Export_"+g].exportFailedHtml(r);if($.Export.timeoutObj.get(g)){clearTimeout($.Export.timeoutObj.get(g));}$.Export.fileSerilObj.removeKey(g);}});}e();},cancelExportDynamicLoading:function(d,c,f){if($.Export.timeoutObj.get(this.userDefinedId)){clearTimeout($.Export.timeoutObj.get(this.userDefinedId));
}var a="";var e=$.Export.fileSerilObj.get(this.userDefinedId);a+="listenerMethod=cancel&serviceName="+d+"&fileSerializeId="+e;if(f){if(f.substring(0,1)=="?"){a+="&"+f.substring(1,f.length);}else{if(f.substring(0,1)=="&"){a+=f;}else{a+="&"+f;}}}var b=this.userDefinedId;$.ajaxRequest({url:$.redirect.parseUrl(c),data:a,type:"POST",datatype:"json",encoding:"UTF-8",success:function(g){},error:function(g,h){window["Export_"+b].initDynamicValue();
}});$.Export.fileSerilObj.removeKey(this.userDefinedId);$("#wade_export_config_article_"+this.userDefinedId).html("");window["Export_"+this.userDefinedId].initDynamicValue();},exportCompleteHtml:function(e){window["Export_"+this.userDefinedId].toggleHtml("exporting","exportButton");var c=$("#wade_export_complete_"+this.userDefinedId);
if(c&&c.length>0){return;}var d=new Array();d.push('<div><span id="wade_export_complete_'+this.userDefinedId+'">'+e+"</span>"+$.lang["view.web.comp.export.compl"]+"</div>");d.push('<span class="e_progress e_progress-big e_progress-ok l_mt">');d.push('<span class="e_progressBar" style="width:100%;"></span>');
d.push('<span class="e_progressValue" >100%</span>');d.push('</span><div class="l_mt"><span class="e_tip">');d.push($.lang.get("view.web.comp.export.down",'<a href="#nogo" id="wade_export_exportFilePath_complete_'+this.userDefinedId+'">',"</a>"));d.push('</span></div><div class="l_mt e_right">');d.push('<button class="e_button-form"  id="wade_export_complete_button_'+this.userDefinedId+'"><i class="e_ico-ok"></i><span>'+$.lang["view.web.comp.export.ok"]+"</span></button>");
d.push("</div>");$("#wade_export_config_article_"+this.userDefinedId).html(d.join(""));var b=window["Export_"+this.userDefinedId].initPosition();$("#wade_export_"+this.userDefinedId).css("top",b.topPx+"px");$("#wade_export_"+this.userDefinedId).css("left",b.leftPx+"px");$("#wade_export_"+this.userDefinedId).css("width",b.widthPx+"px");
var a=this.userDefinedId;this.onAfterAction("ok");$("#wade_export_complete_button_"+this.userDefinedId).bind("click",function(){window["Export_"+a].onExportAction("ok");window["Export_"+a].toggleHtml("wade_export_config_article_");$("#wade_export_config_article_"+a).html("");window["Export_"+a].initDynamicValue();
});},exportFailedHtml:function(d){window["Export_"+this.userDefinedId].toggleHtml("exporting","exportButton");var e=$("#wade_export_failed_file_name_"+this.userDefinedId);if(e&&e.length>0){return;}var c=new Array();c.push('		<span class="e_red"><span id="wade_export_failed_file_name_'+this.userDefinedId+'"></span>'+$.lang["view.web.comp.export.fail"]+"</span><br />");
c.push('		<span id="wade_export_failed_reason_'+this.userDefinedId+'">'+d+"</span>");c.push('		<div class="l_mt e_right">');c.push('			<button class="e_button-form"   id="wade_export_failed_button_'+this.userDefinedId+'"><i class="e_ico-ok"></i><span>'+$.lang["view.web.comp.export.ok"]+"</span></button>");
c.push("		</div>");$("#wade_export_config_article_"+this.userDefinedId).html(c.join(""));var b=window["Export_"+this.userDefinedId].initPosition();$("#wade_export_"+this.userDefinedId).css("top",b.topPx+"px");$("#wade_export_"+this.userDefinedId).css("left",b.leftPx+"px");$("#wade_export_"+this.userDefinedId).css("width",b.widthPx+"px");
var a=this.userDefinedId;this.onAfterAction("error");$("#wade_export_failed_button_"+this.userDefinedId).bind("click",function(){window["Export_"+a].onExportAction("fail");window["Export_"+a].toggleHtml("wade_export_config_article_");window["Export_"+a].toggleHtml("wade_export_");$("#wade_export_config_article_"+a).html("");
window["Export_"+a].initDynamicValue();});},configBaseHtml:function(d,f,c){var h="wade_export_"+this.userDefinedId;var a=$("#exportButton"+this.userDefinedId).attr("fileType");var g=$("#exportButton"+this.userDefinedId).attr("fileName");var b=null;if(a&&a!="null"&&a!="undefined"){b=new $.DataMap(a);}var e=new Array();
if(d!=null&&f!=null&&c!=null){e.push('<div class="c_option" id="'+h+'" style="top:'+d+"px; left:"+f+"px; width:"+c+'px;visibility:hidden; ">');}else{e.push('<div class="c_option" id="'+h+'" style="visibility:hidden; ">');}e.push('<div class="c_optionContent" id="wade_export_config_content_'+this.userDefinedId+'">');
e.push('	<div class="c_form c_form-col-1 c_form-label-3" id="wade_export_form_'+this.userDefinedId+'"><!-- 表单填写 -->');e.push('		<ul class="ul">');e.push('			<li class="li">');e.push('				<span class="label">'+$.lang["view.web.comp.export.name"]+"</span>");e.push('				<span class="e_elements">');e.push('					<span class="e_select e_select-right e_select-right-fixed"><span><span>');
e.push('						<select id="wade_export_filesuffix_'+this.userDefinedId+'" >');if(b){b.eachKey(function(i,j){e.push('<option value="'+i+'">'+j+"</option>");});}else{e.push('								<option value=".xls">.xls</option><option value=".xlsx">.xlsx</option>');e.push('								<option value=".txt">.txt</option><option value=".csv">.csv</option>');
}e.push("						</select>");e.push("					</span></span></span>");if(g&&g!="undefined"&&g!="null"){e.push('<span class="e_input e_input-left"><span><input type="text" id="wade_export_filename_'+this.userDefinedId+'" value="'+g+'" /></span></span>');}else{e.push('<span class="e_input e_input-left"><span><input type="text" id="wade_export_filename_'+this.userDefinedId+'" value="" /></span></span>');
}e.push("				</span>");e.push("			</li>");e.push('			<li class="li" id="wade_export_timer_'+this.userDefinedId+'" style="display:none;">');e.push($.lang.get("view.web.comp.export.start",'<span class="e_tip">','<span id="wade_export_total_datasize_'+this.userDefinedId+'">0</span>','<span class="e_orange" id="wade_export_start_time_'+this.userDefinedId+'">'," 00:00</span>",'<span id="wade_export_export_use_time_'+this.userDefinedId+'"> 0',"</span>","</span>"));
e.push("			</li>");e.push("		</ul>"+'		<div class="submitPlace"></div>');e.push('		<div class="submit">');e.push('			<button class="e_button-form" id="wade_export_cancel_export_'+this.userDefinedId+'"><i class="e_ico-cancel"></i><span>'+$.lang["view.web.comp.export.cancel"]+"</span></button>");e.push('			<button class="e_button-form l_ml" id="wade_export_begin_export_'+this.userDefinedId+'"><i class="e_ico-play"></i><span>'+$.lang["view.web.comp.export.begin"]+"</span></button>");
e.push("		</div>");e.push("	</div>");e.push('	<div class="c_article" id="wade_export_config_article_'+this.userDefinedId+'" style="display:none;">');e.push("	</div>");e.push("</div>");e.push('<div class="c_optionShadow"></div>');e.push('<!--[if IE 6]><iframe class="c_optionCover"></iframe><![endif]-->');
e.push("</div>");return e.join("");}};$.Export.fn.constructor.prototype=$.Export.fn;$.Export.get=$.Export.fn.get;$.Export["timeoutObj"]=new $.DataMap();$.Export["fileSerilObj"]=new $.DataMap();$.Export["dynamicParams"]=new $.DataMap();}})();