(function(a){if(typeof(a.guide)=="undefined"){a.guide=function(b){return new a.guide.fn.construct(b);};a.guide.fn={construct:function(b){this.id=b;this.listId=b+"_anchors";this.initEvents();},get:function(b){return window["Guide_"+b];},getSteps:function(){var c=a("#"+this.listId).children();var b=new Array();
for(var d=0;d<c.length;d++){b[d]=this.getStepByIndex(d);}return b;},getActiveStep:function(){var c=null;var d=a("#"+this.listId+" li[class *= active]");if(d&&d.length==1){var e=a(d.get(0)).find("a").text();var b=this.indexOf(e);c=this.getStepByIndex(parseInt(b));}return c;},getStepByIndex:function(e){var f=null;
var c=a("#"+this.listId).children();if(e>=0&&e<c.length){var b=c.get(e);var g=a(b).find("a");var d=g.attr("href");var h=g.text();f={anchor:d,text:h};}return f;},initSteps:function(b){var c=this;if(a.isArray(b)==false){alert("can not init steps for guide '"+this.id+"', steps must be array.");return;}c.cleanup();
a.each(b,function(d,e){c.addStep(e["text"],e["anchor"]);});},cleanup:function(){a("#"+this.listId).html("");},addStep:function(l,e,g){if(a.isString(l)==false||a.trim(l)==""){alert("can not add step to guide '"+this.id+"', text is required.");return;}if(a.isString(e)==false||a.trim(e)==""){alert("can not add step to guide '"+this.id+"', anchor is required.");
return;}var f=a("#"+this.listId);var b=f.children().length;g=g==undefined?b:g;if(g<0||(b>0&&g>b)){return;}var c=a('<li class=""><a href="'+(e.match("^#")=="#"?e:"#"+e)+'">'+l+"</a></li>");var d=this.indexOf(l);if(d>=0){var k=a(f.children().get(d));k.replaceWith(c);}else{if(b==g){c.appendTo(f);}else{var m=f.children().get(g);
c.insertBefore(m);}}$allItem=f.children();var j="first";var h="last";$allItem.removeClass(j);$allItem.removeClass(h);a($allItem.first()).addClass(j);a($allItem.last()).addClass(h);},activeStep:function(e){if(a.isString(e)){var d=this.indexOf(e);if(d>=0){var b=a("#"+this.listId).children();var g=a(b.get(d));
var f=g.find("a")[0];if(document.all){f.click();}else{if(document.createEvent){var c=document.createEvent("MouseEvents");c.initEvent("click",false,true);f.dispatchEvent(c);}}this.selectStep(e);}}},selectStep:function(e){if(a.isString(e)){var d=this.indexOf(e);if(d>=0){var c=a("#"+this.listId).children();
var f=a(c.get(d));var b="active";a("#"+this.listId+" li[class *= active]").removeClass(b);f.addClass(b);}}},removeStep:function(f){var c=a("#"+this.listId).children();var b=a(c.get(this.indexOf(f)));if(b&&b.length>0){b.remove();c=a("#"+this.listId).children();var e="first";var d="last";c.removeClass(e);
c.removeClass(d);a(c.first()).addClass(e);a(c.last()).addClass(d);}},indexOf:function(d){if(a.isString(d)==false){return -1;}var c=-1;var b=a("#"+this.listId).children();a.each(b,function(e,f){var g=a(f).find("a").text();if(a.trim(g)==a.trim(d)){c=e;return;}});return c;},initEvents:function(){var b=this;
a("#"+b.listId).bind("click",function(e){var g=e.target;if(g.tagName.toUpperCase()==="A"){var d=b.getActiveStep();var f=(d==null?null:d["text"]);var c=a(g).text();if((f!=c)&&(b.onSwitchAction(f,c)!=false)){b.selectStep(c);}}});},onSwitchAction:function(h,f){var b=true;var j=a("#"+this.id).attr("switchAction");
if(j){var e=j.indexOf("(");var d=e>0?j.substring(0,e):j;var c=a("#"+this.id)[0];var g="return window."+d+"?"+d+".call(t, c, n):false;";b=new Function("t","c","n",g)(c,h,f);}return b;}};a.guide.fn.construct.prototype=a.guide.fn;a.guide.get=a.guide.fn.get;}})(Wade);