(function(){if(typeof($.print)=="undefined"){$.print=function(c,d,a,b){return new $.print.fn.construct(c,d,a,b);};$.print.fn={construct:function(c,d,a,b){this.printId=c;this.versionValue=a;this.codeValue=d;this.beforeAction=b;},get:function(a){return window["Print_"+a];},createPrintControl:function(){if(!$.print.printObj){if(Wade.browser["msie"]){try{$.print.printObj=new ActiveXObject("Wade3Printer.Printer");
}catch(a){}}else{if($("#wade4-com-proxy").length==0){$(document.body).append('<embed id="wade4-com-proxy" type="application/wade4-com-proxy" hidden="true"></embed>');}$.print.printObj=$("#wade4-com-proxy")[0];}if(!$.print.printObj){alert($.lang["view.web.comp.print.tip"]);}}return $.print.printObj;},printPage:function(c,e,d,a){var b=$.redirect.buildUrl(c,e,d,"");
this.printHTML(b,a);},printHTML:function(b,a){this.print(b,"HTML",a);},printDoc:function(b,a){this.print(b,"WORD",a);},print:function(b,g,d){if(this.beforeAction&&this.beforeAction!="null"&&this.beforeAction!="undefined"){var j=true;if($.isFunction(this.beforeAction)){j=this.beforeAction.call(this,this.printId);
}else{j=new Function("return "+this.beforeAction)().call(this,this.printId);}if(j==false){return;}}var h="http://"+window.location.host+window.location.pathname;if("WORD"==g){if(b.indexOf("http://")==-1&&b.indexOf("ftp:")==-1){if(b.substring(0,1)=="/"){b="http://"+window.location.host+b;}else{b="http://"+window.location.host+"/"+b;
}}}else{if(b.indexOf("http://")==-1&&b.indexOf("ftp:")==-1){var c=b.indexOf("?service=");if(c==0){b=window.location.pathname+b;}if(b.substring(0,1)=="/"){b="http://"+window.location.host+b;}else{b="http://"+window.location.host+"/"+b;}}}var f=this.createPrintControl();var e=this.buildPrintData($.redirect.parseUrl(b),g,d);
if(Wade.browser["msie"]){f.DoPrint(e);}else{var a=f.exec("Wade3Printer.Printer","DoPrint",e);if(a!=0){alert(a.getErr());}}},buildPrintData:function(b,e,a){this.addTemplateParams(a);var c=$.print.dynamicTemplateParams.get(this.printId);if(c&&c!="undefined"&&c!="null"){if(c.lastIndexOf(",")==(c.length-1)){c=c.substring(0,c.length-1);
}if(c.substring(0,1)==","){c=c.substring(1,c.length);}}if(b.indexOf("template_code")==-1){if(b.indexOf("?")==-1){b+="?template_code="+this.codeValue;}else{b+="&template_code="+this.codeValue;}}if(b.indexOf("version")==-1){if(b.indexOf("?")==-1){b+="?version="+this.versionValue;}else{b+="&version="+this.versionValue;
}}var d=$.print.dynamicParams.get(this.printId);if(d){b+="&"+d;}b=$.redirect.parseUrl(b);$.print.dynamicTemplateParams.put(this.printId,"");if(c&&c!="undefined"&&c!="null"){return'[{"TEMP_PATH":"'+b+'","TEMP_TYPE":"'+e+'",'+c+"}]";}else{return'[{"TEMP_PATH":"'+b+'","TEMP_TYPE":"'+e+'"}]';}},updateTemplate:function(b,a){this.versionValue=a;
this.codeValue=b;},updateParams:function(c){var b="";if(c instanceof $.DataMap){b=$.param(c.map);}else{if($.isString(c)){b=c;}else{b=$.param(c);}}var a=b?b.substring(0,1):"";if(a=="&"||a=="?"){b=b.substring(1);}$.print.dynamicParams.put(this.printId,b);},addTemplateParams:function(c){var a=$.print.dynamicTemplateParams.get(this.printId);
if(!a||a=="undefined"){a="";}if($.isPlainObject(c)){for(var b in c){a+='"'+b+'":"'+c[b]+'",';}}else{if(c instanceof $.DataMap){c.eachKey(function(d){a+='"'+d+'":"'+c.get(d)+'",';});}else{a+=c;}}$.print.dynamicTemplateParams.put(this.printId,a);},addPrintParams:function(a,b){var c=this.createPrintControl();
if(Wade.browser["msie"]){c.SetParam(a,b);}else{c.exec("Wade3Printer.Printer","SetParam",a,b);}},getPrintParams:function(a){var c="";var b=this.createPrintControl();if(Wade.browser["msie"]){c=b.GetParam(a);}else{c=b.exec("Wade3Printer.Printer","GetParam",a);}return c;},setPos:function(b,a){var c=$.print.fn.createPrintControl();
if(b){c.SetLeft(b);}if(a){c.SetTop(a);}}};$.print.fn.construct.prototype=$.print.fn;$.print.setPos=$.print.fn.setPos;$.print.get=$.print.fn.get;$.print.dynamicTemplateParams=new $.DataMap();$.print.dynamicParams=new $.DataMap();$.print.printObj;}})();