(function(a){if(typeof(a.simpleUpload)=="undefined"){a.simpleUpload=function(c,b){return new a.simpleUpload.fn.construct(c,b);};a.simpleUpload.fn={construct:function(c,b){this.id=c;a.extend(this,b);},init:function(){var b=this;var c={flash_url:"component/upload/swfupload.swf",flash9_url:"component/upload/swfupload_fp9.swf",upload_url:"attach?action=upload&random="+Math.random()+"&ftpSite="+b.ftpSite+"&filePath="+b.filePath+"&needSuffix="+b.needSuffix,file_size_limit:b.fileSize+" MB",file_types:b.fileTypes,file_types_description:b.fileTypesDesc,file_queue_limit:0,button_placeholder_id:"SIMPLEUPLOAD_FLASH_"+b.id,button_width:83,button_height:23,button_action:-100,button_image_url:"ecl/base/button-upload-right"+a.lang["view.web.comp.upload.image"]+".png",custom_settings:{file_field_id:b.id,file_need_suffix:b.needSuffix},button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,button_cursor:SWFUpload.CURSOR.HAND,file_queue_error_handler:b.fileQueueError,file_dialog_complete_handler:b.fileDialogComplete,upload_start_handler:b.uploadStart,upload_progress_handler:b.uploadProgress,upload_error_handler:b.uploadError,upload_success_handler:b.uploadSuccess};
this.SimpleUploadObject=new SWFUpload(c);},fileQueueError:function(c,e,d){try{switch(e){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:alert(a.lang.get("view.web.comp.upload.sizelimit","["+this.settings.file_size_limit+"]"));break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:alert(a.lang["view.web.comp.upload.size0"]);
break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:alert(a.lang.get("view.web.comp.upload.type",c["type"]));break;case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:alert(a.lang.get("view.web.comp.upload.num","["+this.settings.file_upload_limit+"]"));break;default:alert(a.lang["view.web.comp.upload.error"]+d);
break;}}catch(b){this.debug(b);}var g=this.customSettings.file_field_id;a("#"+g).val("");a("#"+g+"_filename").val("");var f=a("#SIMPLEUPLOAD_SPAN_"+g);f.addClass("e_orange");f.html(a.lang["view.web.comp.upload.retry"]);if(window["SimpleUpload_"+g].afterAction){window[window["SimpleUpload_"+g].afterAction].call(window,"fail",g);
}},fileDialogComplete:function(c,e,b){try{this.startUpload();}catch(d){this.debug(d);}},uploadStart:function(b){var d=this.customSettings.file_field_id;var c=a("#SIMPLEUPLOAD_SPAN_"+d);c.removeClass("e_orange");c.html('<i class="e_ico-loading"></i>'+a.lang["view.web.comp.upload.uploading"]);return true;
},uploadProgress:function(b,d,c){},uploadSuccess:function(f,g){var i;var c=this.customSettings.file_field_id;try{var h;var l=a.format.lowercase(f.type);if(l===".xls"||l===".xlsx"){h="xls";}else{if(l===".doc"||l===".docx"){h="doc";}else{if(l===".txt"){h="txt";}else{if(l===".xml"){h="xml";}else{if(l===".gif"||l===".jpg"||l===".png"||l===".ioc"){h="pic";
}else{h="file";}}}}}i=a.parseJSON(g);var j=a("#"+c);var b=j.val();j.val(i.data.fileId);a("#"+c+"_filename").val(f.name);var d=a("#SIMPLEUPLOAD_SPAN_"+c);d.removeClass("e_orange");d.html(a.lang["view.web.comp.upload.afterupl"]+"<i class='e_ico-"+h+"'></i>"+f.name);if(b&&(j.attr("isupload")=="yes")&&(window["SimpleUpload_"+c].fileDelete=="true")){a.post("attach?action=delete","fileId="+b+"&needSuffix="+window["SimpleUpload_"+c].needSuffix,function(e){},"POST");
}j.attr("isupload","yes");if(window["SimpleUpload_"+c].afterAction){window[window["SimpleUpload_"+c].afterAction].call(window,"success",c);}}catch(k){if(!i){alert(g);this.clearData();}this.debug(k);}},clearData:function(){var b=a("#"+this.id).val();if(b&&(this.fileDelete=="true")){a.post("attach?action=delete","fileId="+b+"&needSuffix="+window["SimpleUpload_"+this.id].needSuffix,function(c){},"POST");
}a("#SIMPLEUPLOAD_SPAN_"+this.id).removeClass("e_orange");a("#SIMPLEUPLOAD_SPAN_"+this.id).html("");a("#"+this.id).val("");a("#"+this.id+"_filename").val("");if(this.afterAction){window[this.afterAction].call(window,"del",this.id);}},uploadError:function(c,e,d){try{switch(e){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:alert(a.lang["view.web.comp.upload.disconnect"]);
break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:alert(a.lang["view.web.comp.upload.fail"]+d);break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:alert(a.lang["view.web.comp.upload.readfail"]+d);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:alert(a.lang["view.web.comp.upload.authority"]+d);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:alert(a.lang["view.web.comp.upload.content"]+"["+c["name"]+"]");
break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:alert(a.lang["view.web.comp.upload.verify"]+"["+c.name+"]ï¼Œ"+d);break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:alert(a.lang.get("view.web.comp.upload.canceled","["+c.name+"]"));break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:alert(a.lang.get("view.web.comp.upload.stop","["+c.name+"]"));
break;default:break;}}catch(b){this.debug(b);}var g=this.customSettings.file_field_id;a("#"+g).val("");a("#"+g+"_filename").val("");var f=a("#SIMPLEUPLOAD_SPAN_"+g);f.addClass("e_orange");f.html(a.lang["view.web.comp.upload.retry"]);if(window["SimpleUpload_"+g].afterAction){window[window["SimpleUpload_"+g].afterAction].call(window,"fail",g);
}}};a.simpleUpload.fn.construct.prototype=a.simpleUpload.fn;}})(Wade);$(window).bind("unload",function(){$("span[swfdelete=delete]").html("");});